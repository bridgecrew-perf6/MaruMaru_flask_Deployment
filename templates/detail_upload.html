{% extends 'base.html' %}

{% block title %} 수정페이지 {% endblock %}


{% block js %}
    <script src="/static/js/detail_upload.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.js"></script>
    <script defer src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
{% endblock %}

{% block csslink %}
    <link rel="stylesheet" href="/static/css/detail_upload.css">
{% endblock %}


{% block innerjs %}
    <script>
    let g_id = "{{ post['number'] }}"
    let g_title = "{{ post['title'] }}"
    let g_contents = "{{ post['contents'] }}"

    $(document).ready(function () {
        get_db_post()
    })

    function get_db_post() {
        let title = "{{ post["title"]}}"
        let content = "{{ post["contents"]}}"

        $("#title_box").val(title)
        $("#contents_box").val(content)
    }


    function save_upload() {
        let new_title = $("#title_box").val()
        let new_content = $("#contents_box").val()
        $.ajax({
            type: "POST",
            url: `/detail/upload`,
            data: {
                id_give: g_id,
                title_give: new_title,
                contents_give: new_content
            },
            success: function (response) {
                alert(response["msg"])
                window.location.href = `/detail/{{ id }}`
            }
        });
    }
    </script>
{% endblock %}

{% block libutton %}
        <li><a href="/list">게시물 보기</a></li>
    {% endblock %}


{% block content %}
<div class="container">
    <div class="row">
        <div class="col col-md-12">
            <!-- 작성자 -->
            <div class="author">
                <div class="input-group mb-3">
                    <span class="input-group-text">작성자</span>
                    <div id="author_box" type="text" class="form-control" placeholder="" aria-label="Username"
                         aria-describedby="basic-addon1">
                        {{ post['author'] }}
                    </div>
                </div>
            </div>
            <div class="title">
                <div class="input-group mb-3">
                    <span class="input-group-text">제목</span>
                    <input id="title_box" type="text" class="form-control" aria-label="Username"
                           aria-describedby="basic-addon1">
                </div>
            </div>

            <div class="contents">
                <div class="input-group mb-3">
                    <textarea class="form-control" placeholder="내용을 작성해주세요!" aria-label="With textarea"
                              id="contents_box"></textarea>
                </div>
            </div>
            <!-- 버튼 그룹 -->
            <div class="detail_button">
                <button onclick="save_upload()" type="button" class="btn btn-primary ui button"><i
                    class="fas fa-arrow-circle-up"></i> 저장
                </button>
                <button onclick="window.location.href='/detail/{{ id }}'" type="button"
                        class="btn btn-secondary ui button"><i class="fa fa-undo" aria-hidden="true"></i> 취소
                </button>
                &nbsp;
            </div>

        </div>
    </div>
</div>

{% endblock %}